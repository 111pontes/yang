module syslog {
  namespace "urn:ietf:params:xml:ns:yang:syslog";
  prefix syslog;
  import syslog-types {
    prefix syslogtypes;
  }

  organization "IETF NETMOD (NETCONF Data Modeling Language) Working Group";
  contact
    "WG Web:   <http://tools.ietf.org/wg/netmod/>
     WG List:  <mailto:netmod@ietf.org>
     
     WG Chair: David Kessens
               <mailto:david.kessens@nsn.com>
     
     WG Chair: Juergen Schoenwaelder
               <mailto:j.schoenwaelder@jacobs-university.de>
     
     Editor:   Ladislav Lhotka
               <mailto:lhotka@nic.cz>";
  description
    "This module contains a collection of YANG definitions 
     for syslog configuration.";

  revision 2014-06-10 {
    description
      "Initial revision.";
  }

  feature global-logging {
    description
      "This feature represents the ability to adjust 
       log message severity per logging facility on the global level.";
  }

  feature console-facility-logging-config {
    description
      "This feature represents the ability to adjust 
       log message severity per logging facility for console logging.";
  }

  feature file-logging {
    description
      "This feature represents the ability to log 
       messages into a file.";
  }

  feature file-facility-logging-config {
    description
      "This feature represents the ability to adjust 
       log message severity per logging facility for file logging.";
  }

  feature terminal-facility-logging-config {
    description
      "This feature represents the ability to adjust 
       log message severity per logging facility for terminal logging.";
  }

  feature terminal-facility-user-logging-config {
    description
      "This feature represents the ability to adjust 
       log message settings for individual terminal users.";
  }

  feature use-vrf {
    description
      "This feature allows logging of messages to a particular VRF.";
  }

  grouping FACILITY-LOGGING {
    list logging-severities {
      key "facility";
      leaf facility {
        type identityref {
          base syslogtypes:syslog-facility;
        }
        description
          "The logging facility to be configured.";
      }
      leaf severity {
        type syslogtypes:Severity;
        description
          "The logging severity to be configured.";
      }
    }
  }

  container syslog-cfg {
    description
      "syslog";
    config true;
    container global-logging {
      if-feature global-logging;
      description
        "Global logging configuration.";
      uses FACILITY-LOGGING;
    }
    container console-logging {
      description
        "Console logging configuration.";
      choice logging-level-scope {
        case all-facilities {
          leaf logging-severity {
            type syslogtypes:Severity;
          }
        }
        case facility {
          if-feature console-facility-logging-config;
          uses FACILITY-LOGGING;
        }
      }
    }
    container file-logging {
      if-feature file-logging;
      description
        "File logging configuration.";
      leaf file-name {
        mandatory true;
        type string;
        description
          "File Logging Level";
      }
      leaf file-size {
        type uint32;
        description
          "Logging file size";
      }
      choice logging-scope {
        case all-facilities {
          leaf logging-severity {
            type syslogtypes:Severity;
          }
        }
        case facility {
          if-feature file-facility-logging-config;
          uses FACILITY-LOGGING;
        }
      }
    }
    container remote-logging {
      description
        "Remote logging configuration.";
      list remote-logging-destination {
        key "destination";
        leaf destination {
          type string;
          description
            "The value of Id should be set to either ipv4, ipv6 or the host name used to identify
             the logging destination";
        }
        uses FACILITY-LOGGING;
        leaf source-interface {
          description
            "Sets source interface for the remote syslog server. Can be interface name or interface IP address.";
          type string;
        }
        leaf vrf-name {
          if-feature use-vrf;
          type string;
          description
            "Name of the VRF";
        }
      }
    }
    container terminal-logging {
      description
        "Terminal logging configuration.";
      choice user-scope {
        case all-users {
          container all-users {
            choice logging-scope {
              case all-facilities {
                leaf logging-severity {
                  type syslogtypes:Severity;
                }
              }
              case facility {
                if-feature terminal-facility-logging-config;
                uses FACILITY-LOGGING;
              }
            }
          }
        }
        case per-user {
          if-feature terminal-facility-user-logging-config;
          list user-name {
            key "uname";
            leaf uname {
              type string;
            }
            choice logging-scope {
              case all-facilities {
                leaf logging-severity {
                  type syslogtypes:Severity;
                }
              }
              case facility {
                if-feature terminal-facility-logging-config;
                uses FACILITY-LOGGING;
              }
            }
          }
        }
      }
    }
  }
}
